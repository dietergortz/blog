<!doctype html><html lang=en dir=auto><head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Celltris - Tetris in Excel from Scratch | Dieter Görtz</title>
<meta name=keywords content="excel,tetris,vba"><meta name=description content="I wanted to create a Tetris-like game in Excel without referencing code on the internet. Thus what follows is a brief look at the process I followed to create Celltris (cough I know).
Total coding time: Roughly 3-4 days over the Christmas period.
If you would like to take a look at the code (and play the game!), grab it from the Gitlab page here.
Disclosure: I ended up having to look up two things:"><meta name=author content="Dieter"><link rel=canonical href=http://localhost:1313/blog/posts/celltris/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/blog/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/blog/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/blog/posts/celltris/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Celltris - Tetris in Excel from Scratch"><meta property="og:description" content="I wanted to create a Tetris-like game in Excel without referencing code on the internet. Thus what follows is a brief look at the process I followed to create Celltris (cough I know).
Total coding time: Roughly 3-4 days over the Christmas period.
If you would like to take a look at the code (and play the game!), grab it from the Gitlab page here.
Disclosure: I ended up having to look up two things:"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/blog/posts/celltris/"><meta property="og:image" content="http://localhost:1313/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-12-31T16:51:57+00:00"><meta property="article:modified_time" content="2018-12-31T16:51:57+00:00"><meta property="og:site_name" content="Dieter Görtz"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Celltris - Tetris in Excel from Scratch"><meta name=twitter:description content="I wanted to create a Tetris-like game in Excel without referencing code on the internet. Thus what follows is a brief look at the process I followed to create Celltris (cough I know).
Total coding time: Roughly 3-4 days over the Christmas period.
If you would like to take a look at the code (and play the game!), grab it from the Gitlab page here.
Disclosure: I ended up having to look up two things:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/blog/posts/"},{"@type":"ListItem","position":2,"name":"Celltris - Tetris in Excel from Scratch","item":"http://localhost:1313/blog/posts/celltris/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Celltris - Tetris in Excel from Scratch","name":"Celltris - Tetris in Excel from Scratch","description":"I wanted to create a Tetris-like game in Excel without referencing code on the internet. Thus what follows is a brief look at the process I followed to create Celltris (cough I know).\nTotal coding time: Roughly 3-4 days over the Christmas period.\nIf you would like to take a look at the code (and play the game!), grab it from the Gitlab page here.\nDisclosure: I ended up having to look up two things:","keywords":["excel","tetris","vba"],"articleBody":"I wanted to create a Tetris-like game in Excel without referencing code on the internet. Thus what follows is a brief look at the process I followed to create Celltris (cough I know).\nTotal coding time: Roughly 3-4 days over the Christmas period.\nIf you would like to take a look at the code (and play the game!), grab it from the Gitlab page here.\nDisclosure: I ended up having to look up two things:\nThe rules for Tetris since I couldn’t remember the column and row counts. The vba timer function. I started off attempting to use sleep(), bad idea. I used two 2d arrays, the first for the game board’s data, the second for the current falling shape. The latter having 2 rows more than the first, thus a 22x10 array and a 20x10. The two additional rows in the shape array allowed spawning of the shapes above the game board. Since the shapes drop one row at a time, these two hidden rows provided a smooth single row drop into the game board.\nAt the start of the game a timer variable (type single) stores the VBA timer. A simple while-game-is-not-over loop runs, creates a shape, then a secondary loop runs which checks the elapsed time (game speed and level). If the correct amount of time has elapsed, the shape is dropped one row, and if not possible to drop, the secondary loop exits and a new shape is created.\nAll the shapes are represented as numbers in the arrays, the square or O is 1, the Z is 2, S is 3 and so on. I used Excel’s conditional formatting for each shape’s colouring.\nShapes are hardcoded when spawning in and rotated. Rotation checks the shape’s current position by verifying blank co-ordinates in the shape’s region, then by recreating the shape based on the result. This could probably be done a lot smarter, but since I did not want to reference any code, this was the best I could come up with. Rotation is fairly rudimentary and does not follow the rotation rules for Tetris, which I may revisit and correct one day.\nOverall, I was pretty pleased with the result and threw in a nod to Acid Tetris with the smiley face changing as the game is played. All shapes/images have been created in Excel and are simple excel shapes/flowchart items.\nLast updated 23/04/2019 to fix a typo.\n","wordCount":"403","inLanguage":"en","image":"http://localhost:1313/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2018-12-31T16:51:57Z","dateModified":"2018-12-31T16:51:57Z","author":{"@type":"Person","name":"Dieter"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/blog/posts/celltris/"},"publisher":{"@type":"Organization","name":"Dieter Görtz","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon-16x16.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/blog/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/blog/posts/ title=posts><span>posts</span></a></li><li><a href=http://localhost:1313/blog/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/blog/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/blog/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Celltris - Tetris in Excel from Scratch</h1><div class=post-meta><span title='2018-12-31 16:51:57 +0000 UTC'>31 December, 2018</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Dieter</div></header><div class=post-content><p>I wanted to create a Tetris-like game in Excel without referencing code on the internet. Thus what follows is a brief look at the process I followed to create Celltris (<em>cough</em> I know).</p><p>Total coding time: Roughly 3-4 days over the Christmas period.</p><p><img loading=lazy src=/blog/gifs/celltris.gif#center alt=Celltris>
If you would like to take a look at the code (and play the game!), grab it from <a href=https://gitlab.com/dieter.g/celltris>the Gitlab page here</a>.</p><p>Disclosure: I ended up having to look up two things:</p><ul><li>The rules for Tetris since I couldn&rsquo;t remember the column and row counts.</li><li>The vba timer function. I started off attempting to use sleep(), bad idea.</li></ul><p>I used two 2d arrays, the first for the game board&rsquo;s data, the second for the current falling shape. The latter having 2 rows more than the first, thus a 22x10 array and a 20x10. The two additional rows in the shape array allowed spawning of the shapes above the game board. Since the shapes drop one row at a time, these two hidden rows provided a smooth single row drop into the game board.</p><p>At the start of the game a timer variable (type single) stores the VBA timer. A simple while-game-is-not-over loop runs, creates a shape, then a secondary loop runs which checks the elapsed time (game speed and level). If the correct amount of time has elapsed, the shape is dropped one row, and if not possible to drop, the secondary loop exits and a new shape is created.</p><p>All the shapes are represented as numbers in the arrays, the square or O is 1, the Z is 2, S is 3 and so on. I used Excel&rsquo;s conditional formatting for each shape&rsquo;s colouring.</p><p><img loading=lazy src=/images/celltris2.png#center alt=ShapeArrays></p><p>Shapes are hardcoded when spawning in and rotated. Rotation checks the shape&rsquo;s current position by verifying blank co-ordinates in the shape&rsquo;s region, then by recreating the shape based on the result. This could probably be done a lot smarter, but since I did not want to reference any code, this was the best I could come up with. Rotation is fairly rudimentary and does not follow the rotation rules for Tetris, which I may revisit and correct one day.</p><p>Overall, I was pretty pleased with the result and threw in a nod to Acid Tetris with the smiley face changing as the game is played. All shapes/images have been created in Excel and are simple excel shapes/flowchart items.</p><p>Last updated 23/04/2019 to fix a typo.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/blog/tags/excel/>Excel</a></li><li><a href=http://localhost:1313/blog/tags/tetris/>Tetris</a></li><li><a href=http://localhost:1313/blog/tags/vba/>Vba</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/blog/>Dieter Görtz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>