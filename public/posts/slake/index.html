<!doctype html><html lang=en dir=auto><head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Slake - Creating snake in Excel | Dieter Görtz</title>
<meta name=keywords content="vba,games,excel"><meta name=description content="It&rsquo;s that time of the year again and I&rsquo;m starting to form what may become a personal tradition - creating a small game at the end of the year. Almost everyone has played snake in one form or another and it has a simple ruleset, making it a quick and fun project to put together.
I pay homage to the [great] game inside a piece of 90&rsquo;s music software called FastTracker II."><meta name=author content="Dieter"><link rel=canonical href=http://localhost:1313/blog/posts/slake/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/blog/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/blog/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/blog/posts/slake/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Slake - Creating snake in Excel"><meta property="og:description" content="It&rsquo;s that time of the year again and I&rsquo;m starting to form what may become a personal tradition - creating a small game at the end of the year. Almost everyone has played snake in one form or another and it has a simple ruleset, making it a quick and fun project to put together.
I pay homage to the [great] game inside a piece of 90&rsquo;s music software called FastTracker II."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/blog/posts/slake/"><meta property="og:image" content="http://localhost:1313/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-12-27T18:35:26+00:00"><meta property="article:modified_time" content="2019-12-27T18:35:26+00:00"><meta property="og:site_name" content="Dieter Görtz"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Slake - Creating snake in Excel"><meta name=twitter:description content="It&rsquo;s that time of the year again and I&rsquo;m starting to form what may become a personal tradition - creating a small game at the end of the year. Almost everyone has played snake in one form or another and it has a simple ruleset, making it a quick and fun project to put together.
I pay homage to the [great] game inside a piece of 90&rsquo;s music software called FastTracker II."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/blog/posts/"},{"@type":"ListItem","position":2,"name":"Slake - Creating snake in Excel","item":"http://localhost:1313/blog/posts/slake/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Slake - Creating snake in Excel","name":"Slake - Creating snake in Excel","description":"It\u0026rsquo;s that time of the year again and I\u0026rsquo;m starting to form what may become a personal tradition - creating a small game at the end of the year. Almost everyone has played snake in one form or another and it has a simple ruleset, making it a quick and fun project to put together.\nI pay homage to the [great] game inside a piece of 90\u0026rsquo;s music software called FastTracker II.","keywords":["vba","games","excel"],"articleBody":"It’s that time of the year again and I’m starting to form what may become a personal tradition - creating a small game at the end of the year. Almost everyone has played snake in one form or another and it has a simple ruleset, making it a quick and fun project to put together.\nI pay homage to the [great] game inside a piece of 90’s music software called FastTracker II. I spent many hours listening to 90’s trance and drum and bass while completing the inbuilt version of snake, called Nibbles.\nYou can view the source and download the game from Gitlab here.\nThe most challenging bit of code was the responsiveness of keystrokes, directing the snake to change direction at a moments notice, and in many cases, performing two or more actions in quick succession.\nBy inserting the change of direction (executed by the worksheet change event) within the master loop, the change of direction is picked up as fast as a loop can run on the machine. When tied together with a string buffer containing keystrokes, the snake can be directed to pick up and make every direction change requested when the update timer triggers, ensuring that nothing is missed.\nThe primary loop: 1 2 3 4 5 6 7 8 9 10 11 12 13 While Not GameOver If moveCompleted Then ChangeDirection '\u003c--- Change direction is called at every possible interval. End If moveCompleted = False If Timer \u003e= frameUpdate Then frameUpdate = Timer + GameSpeed MoveSlake '\u003c--- The snake is only updated once every frame update though. moveCompleted = True PlaceFood End If DoEvents Wend The direction change routine’s only purpose is to locate the range (cell) that the snake’s head should move to: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 Private Sub ChangeDirection() Dim oldLocation As Range, previousDirection As Long previousDirection = CurrentDirection If Len(MoveBuffer) \u003e 0 Then CurrentDirection = Left(MoveBuffer, 1) MoveBuffer = Mid(MoveBuffer, 2) End If 'Safeguard against traveling in the opposite direction If previousDirection = D_UP And CurrentDirection = D_DOWN Then CurrentDirection = D_UP ElseIf previousDirection = D_DOWN And CurrentDirection = D_UP Then CurrentDirection = D_DOWN ElseIf previousDirection = D_LEFT And CurrentDirection = D_RIGHT Then CurrentDirection = D_LEFT ElseIf previousDirection = D_RIGHT And CurrentDirection = D_LEFT Then CurrentDirection = D_RIGHT End If Set oldLocation = slakeSheet.Range(Slake(0)) Select Case CurrentDirection Case D_UP Set NewLocation = oldLocation.Offset(-1) Case D_DOWN Set NewLocation = oldLocation.Offset(1) Case D_LEFT Set NewLocation = oldLocation.Offset(0, -1) Case D_RIGHT Set NewLocation = oldLocation.Offset(0, 1) End Select End Sub And finally, once the snake is moved, only the new location retrieved from the ChangeDirection routine is added to the snake, and the tail bit removed. While the entirety of the snake is kept in an array, movement is only created by adding on a new cell in the front, and removing the last cell at the end, shifting the array along with each piece of food munched.\nHappy holidays!\n","wordCount":"514","inLanguage":"en","image":"http://localhost:1313/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2019-12-27T18:35:26Z","dateModified":"2019-12-27T18:35:26Z","author":{"@type":"Person","name":"Dieter"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/blog/posts/slake/"},"publisher":{"@type":"Organization","name":"Dieter Görtz","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon-16x16.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/blog/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/blog/posts/ title=posts><span>posts</span></a></li><li><a href=http://localhost:1313/blog/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/blog/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/blog/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Slake - Creating snake in Excel</h1><div class=post-meta><span title='2019-12-27 18:35:26 +0000 UTC'>27 December, 2019</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Dieter</div></header><div class=post-content><p>It&rsquo;s that time of the year again and I&rsquo;m starting to form what may become a personal tradition - creating a small game at the end of the year. Almost everyone has played snake in one form or another and it has a simple ruleset, making it a quick and fun project to put together.</p><p><img loading=lazy src=/blog/gifs/slake.gif#center alt=Slake></p><p>I pay homage to the [great] game inside a piece of 90&rsquo;s music software called <a href=https://en.wikipedia.org/wiki/FastTracker_2>FastTracker II</a>. I spent many hours listening to 90&rsquo;s trance and drum and bass while completing the inbuilt version of snake, called Nibbles.</p><p>You can view the source and <a href=https://gitlab.com/dieter.g/slake_excel>download the game from Gitlab here</a>.</p><p>The most challenging bit of code was the responsiveness of keystrokes, directing the snake to change direction at a moments notice, and in many cases, performing two or more actions in quick succession.</p><p>By inserting the change of direction (executed by the worksheet change event) within the master loop, the change of direction is picked up as fast as a loop can run on the machine. When tied together with a string buffer containing keystrokes, the snake can be directed to pick up and make every direction change requested when the update timer triggers, ensuring that nothing is missed.</p><p>The primary loop:<div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb.net data-lang=vb.net><span style=display:flex><span>  <span style=color:#66d9ef>While</span> <span style=color:#66d9ef>Not</span> GameOver
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>If</span> moveCompleted <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>      ChangeDirection <span style=color:#75715e>&#39;&lt;--- Change direction is called at every possible interval.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>    moveCompleted <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>If</span> Timer <span style=color:#f92672>&gt;=</span> frameUpdate <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>      frameUpdate <span style=color:#f92672>=</span> Timer <span style=color:#f92672>+</span> GameSpeed
</span></span><span style=display:flex><span>      MoveSlake <span style=color:#75715e>&#39;&lt;--- The snake is only updated once every frame update though.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      moveCompleted <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>      PlaceFood
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>    DoEvents
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>Wend</span></span></span></code></pre></td></tr></table></div></div></p><p>The direction change routine&rsquo;s only purpose is to locate the range (cell) that the snake&rsquo;s head should move to:<div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb.net data-lang=vb.net><span style=display:flex><span><span style=color:#66d9ef>Private</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>ChangeDirection</span>()
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>Dim</span> oldLocation <span style=color:#f92672>As</span> Range, previousDirection <span style=color:#f92672>As</span> <span style=color:#66d9ef>Long</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  previousDirection <span style=color:#f92672>=</span> CurrentDirection
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>If</span> Len(MoveBuffer) <span style=color:#f92672>&gt;</span> 0 <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>    CurrentDirection <span style=color:#f92672>=</span> Left(MoveBuffer, 1)
</span></span><span style=display:flex><span>    MoveBuffer <span style=color:#f92672>=</span> Mid(MoveBuffer, 2)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>&#39;Safeguard against traveling in the opposite direction
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>If</span> previousDirection <span style=color:#f92672>=</span> D_UP <span style=color:#f92672>And</span> CurrentDirection <span style=color:#f92672>=</span> D_DOWN <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>    CurrentDirection <span style=color:#f92672>=</span> D_UP
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>ElseIf</span> previousDirection <span style=color:#f92672>=</span> D_DOWN <span style=color:#f92672>And</span> CurrentDirection <span style=color:#f92672>=</span> D_UP <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>    CurrentDirection <span style=color:#f92672>=</span> D_DOWN
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>ElseIf</span> previousDirection <span style=color:#f92672>=</span> D_LEFT <span style=color:#f92672>And</span> CurrentDirection <span style=color:#f92672>=</span> D_RIGHT <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>    CurrentDirection <span style=color:#f92672>=</span> D_LEFT
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>ElseIf</span> previousDirection <span style=color:#f92672>=</span> D_RIGHT <span style=color:#f92672>And</span> CurrentDirection <span style=color:#f92672>=</span> D_LEFT <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>    CurrentDirection <span style=color:#f92672>=</span> D_RIGHT
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>Set</span> oldLocation <span style=color:#f92672>=</span> slakeSheet.Range(Slake(0))
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>Select</span> <span style=color:#66d9ef>Case</span> CurrentDirection
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Case</span> D_UP
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>Set</span> NewLocation <span style=color:#f92672>=</span> oldLocation.Offset(<span style=color:#f92672>-</span>1)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Case</span> D_DOWN
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>Set</span> NewLocation <span style=color:#f92672>=</span> oldLocation.Offset(1)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Case</span> D_LEFT
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>Set</span> NewLocation <span style=color:#f92672>=</span> oldLocation.Offset(0, <span style=color:#f92672>-</span>1)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Case</span> D_RIGHT
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>Set</span> NewLocation <span style=color:#f92672>=</span> oldLocation.Offset(0, 1)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Select</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span></span></span></code></pre></td></tr></table></div></div></p><p>And finally, once the snake is moved, only the new location retrieved from the ChangeDirection routine is added to the snake, and the tail bit removed. While the entirety of the snake is kept in an array, movement is only created by adding on a new cell in the front, and removing the last cell at the end, shifting the array along with each piece of food munched.</p><p>Happy holidays!</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/blog/tags/vba/>Vba</a></li><li><a href=http://localhost:1313/blog/tags/games/>Games</a></li><li><a href=http://localhost:1313/blog/tags/excel/>Excel</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/blog/>Dieter Görtz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>